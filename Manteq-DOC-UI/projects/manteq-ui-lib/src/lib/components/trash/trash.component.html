<!-- Header Section -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h4 class="mb-1">
        <i class="bi bi-trash me-2"></i>Trash
      </h4>
      <p class="text-muted mb-0">Manage deleted documents, templates, and emails</p>
    </div>
    <button class="btn btn-danger" (click)="emptyTrash()" [disabled]="allItems().length === 0">
      <i class="bi bi-trash-fill me-1"></i> Empty Trash
    </button>
  </div>

  <!-- Search and Filters -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-8">
          <div class="input-group">
            <span class="input-group-text bg-white">
              <i class="bi bi-search"></i>
            </span>
            <input 
              type="text" 
              class="form-control border-start-0" 
              [(ngModel)]="searchTerm"
              (keyup.enter)="searchItems()"
              placeholder="Search deleted items...">
          </div>
        </div>
        <div class="col-md-4">
          <select class="form-select" (change)="filterByType($any($event.target).value)">
            <option value="all">All Types</option>
            <option value="Document">Documents</option>
            <option value="Template">Templates</option>
            <option value="EmailTemplate">Email Templates</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Trash Items Table -->
  <div class="card">
    <div class="card-body p-0">
      @if (loading()) {
        <div class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
      } @else if (filteredItems().length === 0) {
        <div class="text-center py-5 text-muted">
          <i class="bi bi-trash display-1"></i>
          <p class="mt-3 fs-5">Trash is empty</p>
          <p class="small">Deleted items will appear here</p>
        </div>
      } @else {
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th width="5%">TYPE</th>
                <th>NAME</th>
                <th>DELETED BY</th>
                <th>DELETED DATE</th>
                <th class="text-end">ACTIONS</th>
              </tr>
            </thead>
            <tbody>
              @for (item of paginatedItems(); track item.id) {
                <tr>
                  <td>
                    <i [class]="'bi ' + getTypeIcon(item.type) + ' fs-4 text-muted'"></i>
                  </td>
                  <td>
                    <div>
                      <div class="fw-medium">{{ item.name }}</div>
                      <span [class]="getTypeBadgeClass(item.type)">
                        {{ getTypeLabel(item.type) }}
                      </span>
                    </div>
                  </td>
                  <td>{{ item.deletedBy }}</td>
                  <td>{{ item.deletedAt | dateFormat }}</td>
                  <td class="text-end">
                    <div class="action-buttons action-buttons-wide">
                      <button 
                        class="action-btn action-btn-success action-btn-with-text" 
                        (click)="restoreItem(item)"
                        title="Restore Item">
                        <i class="bi bi-arrow-counterclockwise me-1"></i>
                        Restore
                      </button>
                      <button 
                        class="action-btn action-btn-danger action-btn-with-text" 
                        (click)="permanentlyDelete(item)"
                        title="Delete Permanently">
                        <i class="bi bi-trash-fill me-1"></i>
                        Delete Forever
                      </button>
                    </div>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      }
    </div>
    @if (!loading() && filteredItems().length > 0) {
      <div class="card-footer bg-white">
        <div class="d-flex justify-content-between align-items-center">
          <small class="text-muted">
            Showing {{ (currentPage() - 1) * itemsPerPage() + 1 }} to {{ Math.min(currentPage() * itemsPerPage(), filteredItems().length) }} of {{ filteredItems().length }} items
          </small>
          <div class="d-flex gap-3 align-items-center">
            @if (totalPages() > 1) {
              <nav>
                <ul class="pagination pagination-sm mb-0">
                  <li [class.disabled]="currentPage() === 1" class="page-item">
                    <button class="page-link" (click)="previousPage()" [disabled]="currentPage() === 1">
                      <i class="bi bi-chevron-left"></i>
                    </button>
                  </li>
                  @for (page of pages(); track page) {
                    <li [class.active]="currentPage() === page" class="page-item">
                      <button class="page-link" (click)="goToPage(page)">{{ page }}</button>
                    </li>
                  }
                  <li [class.disabled]="currentPage() === totalPages()" class="page-item">
                    <button class="page-link" (click)="nextPage()" [disabled]="currentPage() === totalPages()">
                      <i class="bi bi-chevron-right"></i>
                    </button>
                  </li>
                </ul>
              </nav>
            }
            <button class="btn btn-sm btn-outline-danger" (click)="emptyTrash()">
              <i class="bi bi-trash-fill me-1"></i>
              Empty Trash ({{ allItems().length }})
            </button>
          </div>
        </div>
      </div>
    }
  </div>

  <!-- Info Alert -->
  @if (allItems().length > 0) {
    <div class="alert alert-info mt-3 mb-0" role="alert">
      <i class="bi bi-info-circle me-2"></i>
      Items in trash can be restored or permanently deleted. Permanently deleted items cannot be recovered.
    </div>
  }
