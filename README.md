# üìÑ Manteq Document System

A **production-ready** document a### **Required Software**
- ‚úÖ **.NET 9.0 SDK** - Download from Microsoft
- ‚úÖ **SQL Server Express** with SQLEXPRESS instance  
- ‚úÖ **LibreOffice** - For document conversion (free download)
- ‚úÖ **Visual Studio Code** or Visual Studio 2022

### **üîí Environment Configuration (Critical)**
**All services use environment variables for database connections - no credentials in code!**

Each service requires a `.env` file with database configuration:
```env
# Database Configuration Template
# Copy this to .env file in each service directory
DB_SERVER=YOUR_SERVER\\SQLEXPRESS
DB_DATABASE=CmsDatabase_Dev  
DB_INTEGRATED_SECURITY=true
DB_TRUST_SERVER_CERTIFICATE=true
```

**Required .env files:**
- `CMS.WebApi/.env`
- `TMS.WebApi/.env` 
- `EmailService.WebApi/.env`

### **üóÇÔ∏è Shared Storage Setup**on platform consisting of **Content Management System (CMS)**, **Template Management System (TMS)**, and **Email Service** built with ASP.NET Core 9.0.

> üî• **Status**: ‚úÖ **PRODUCTION READY** - Fully tested with shared storage architecture and microservices integration

## üèóÔ∏è System Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    MANTEQ DOCUMENT SYSTEM                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üìÅ CMS API          üéØ TMS API          üìß Email Service   ‚îÇ
‚îÇ  localhost:5000      localhost:5267      localhost:5030     ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  ‚Ä¢ Document Storage  ‚Ä¢ Template Engine   ‚Ä¢ SMTP Integration ‚îÇ
‚îÇ  ‚Ä¢ File Management   ‚Ä¢ Format Conversion ‚Ä¢ TMS Integration  ‚îÇ
‚îÇ  ‚Ä¢ Database Access   ‚Ä¢ Placeholder Fill  ‚Ä¢ CMS Integration  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ      SHARED RESOURCES     ‚îÇ
                ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
                ‚îÇ üóÑÔ∏è CmsDatabase_Dev       ‚îÇ
                ‚îÇ üìÅ C:\ManteqStorage_Shared ‚îÇ
                ‚îÇ ‚öôÔ∏è LibreOffice            ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **üéØ Service Integration Flow**
```
User Upload Template ‚Üí TMS ‚Üí Creates Document in CMS ‚Üí Stores in Shared Storage
Generate Document ‚Üí TMS ‚Üí Process Template ‚Üí Save to TmsGenerated (auto-cleanup)
Send Email ‚Üí EmailService ‚Üí Call TMS ‚Üí Generate HTML ‚Üí Send via SMTP
```

## üöÄ Features Overview

### **üìÅ CMS (Content Management System) - Port 5000**
- ‚úÖ **Document Storage**: Centralized file storage in shared directory
- ‚úÖ **Database Integration**: SQL Server with Documents table
- ‚úÖ **File Management**: Upload, download, and metadata tracking
- ‚úÖ **REST API**: Complete CRUD operations with Swagger docs
- ‚úÖ **Security**: File type validation and size limits

### **üéØ TMS (Template Management System) - Port 5267**
- ‚úÖ **Office Template Processing**: Word, Excel, PowerPoint templates
- ‚úÖ **Dynamic Placeholders**: Replace {{PropertyName}} with actual values
- ‚úÖ **Multiple Export Formats**: Word, HTML, EmailHtml, PDF, Original
- ‚úÖ **LibreOffice Integration**: High-quality document conversion
- ‚úÖ **Auto-Cleanup**: Generated files removed every 15 minutes
- ‚úÖ **CMS Integration**: Internal CMS services for template storage
- ‚úÖ **Email-Ready HTML**: Base64 embedded images for email clients

### **üìß Email Service - Port 5030**
- ‚úÖ **TMS Integration**: Generate documents on-the-fly for email content
- ‚úÖ **CMS Integration**: Attach existing documents from CMS
- ‚úÖ **SMTP Support**: Multi-account email configuration
- ‚úÖ **EmailHtml Format**: Template content becomes email body
- ‚úÖ **Health Monitoring**: Service status and configuration checks
- ‚úÖ **Async Processing**: Non-blocking email operations

## üìã Prerequisites

### **Required Software**
- ‚úÖ **.NET 9.0 SDK** - Download from Microsoft
- ‚úÖ **SQL Server Express** with SQLEXPRESS instance  
- ‚úÖ **LibreOffice** - For document conversion (free download)
- ‚úÖ **Visual Studio Code** or Visual Studio 2022

### **ÔøΩÔ∏è Shared Storage Setup**
The system uses centralized file storage that all services share:

```powershell
# Create shared storage directories (run once)
New-Item -ItemType Directory -Path "C:\ManteqStorage_Shared\CmsDocuments" -Force
New-Item -ItemType Directory -Path "C:\ManteqStorage_Shared\TmsGenerated" -Force  
New-Item -ItemType Directory -Path "C:\ManteqStorage_Shared\TmsTemp" -Force
New-Item -ItemType Directory -Path "C:\ManteqStorage_Shared\EmailAttachments" -Force
```

### **üóÑÔ∏è Database Requirements**
```sql
-- Single shared database for all services
CREATE DATABASE CmsDatabase_Dev;

-- Tables are created automatically via Entity Framework:
-- - Documents (CMS) - Stores all documents and templates
-- - Templates (TMS) - References Documents via foreign key
```

## ‚ö° Quick Start (5 Minutes)

### **1. Clone and Setup**
```powershell
# Clone repository
git clone https://github.com/SalehShalab87/Manteq-doc-system.git
cd Manteq-doc-system

# Create shared storage (required)
New-Item -ItemType Directory -Path "C:\ManteqStorage_Shared\CmsDocuments" -Force
New-Item -ItemType Directory -Path "C:\ManteqStorage_Shared\TmsGenerated" -Force  
New-Item -ItemType Directory -Path "C:\ManteqStorage_Shared\TmsTemp" -Force
New-Item -ItemType Directory -Path "C:\ManteqStorage_Shared\EmailAttachments" -Force
```

### **2. Configure Environment Variables**
```powershell
# Create .env files for each service (REQUIRED)
@"
DB_SERVER=YOUR_SERVER\SQLEXPRESS
DB_DATABASE=CmsDatabase_Dev  
DB_INTEGRATED_SECURITY=true
DB_TRUST_SERVER_CERTIFICATE=true
"@ | Out-File -FilePath "CMS.WebApi\.env" -Encoding UTF8

@"
DB_SERVER=YOUR_SERVER\SQLEXPRESS
DB_DATABASE=CmsDatabase_Dev  
DB_INTEGRATED_SECURITY=true
DB_TRUST_SERVER_CERTIFICATE=true
"@ | Out-File -FilePath "TMS.WebApi\.env" -Encoding UTF8

@"
DB_SERVER=YOUR_SERVER\SQLEXPRESS
DB_DATABASE=CmsDatabase_Dev  
DB_INTEGRATED_SECURITY=true
DB_TRUST_SERVER_CERTIFICATE=true
"@ | Out-File -FilePath "EmailService.WebApi\.env" -Encoding UTF8
```

### **3. Build and Run Services**

# Build entire system
dotnet build ManteqDocumentSystem.sln
```

### **2. Start All Services (3 Terminals)**
```powershell
# Terminal 1: CMS (Content Management)
cd CMS.Webapi
dotnet run
# ‚û°Ô∏è Access: http://localhost:5000 (Swagger: http://localhost:5000/swagger)

# Terminal 2: TMS (Template Management) 
cd TMS.WebApi
dotnet run
# ‚û°Ô∏è Access: http://localhost:5267 (Swagger: http://localhost:5267/swagger)

# Terminal 3: Email Service
cd EmailService.WebApi
dotnet run
# ‚û°Ô∏è Access: http://localhost:5030 (Swagger: http://localhost:5030/swagger)
```

### **3. Test the System**
```powershell
# Health check all services
curl http://localhost:5000/api/documents/health
curl http://localhost:5267/api/templates/health  
curl http://localhost:5030/api/email/health

# ‚úÖ All should return: {"status": "healthy"}
```

> **üéâ That's it!** All three services are running and ready to process documents.

## üîó API Endpoints

### **üìÅ CMS APIs (Port 5000)**
```http
# Upload and register documents
POST http://localhost:5000/api/documents/register
Content-Type: multipart/form-data

# Get document metadata  
GET http://localhost:5000/api/documents/{documentId}

# Download document file
GET http://localhost:5000/api/documents/{documentId}/download

# Health check
GET http://localhost:5000/api/documents/health
```

### **üéØ TMS APIs (Port 5267)**
```http
# Register template (creates document in CMS internally)
POST http://localhost:5267/api/templates/register
Content-Type: multipart/form-data

# Generate document from template
POST http://localhost:5267/api/templates/generate
Content-Type: application/json

# Download generated document
GET http://localhost:5267/api/templates/download/{generationId}

# Get template properties (placeholders)
GET http://localhost:5267/api/templates/{templateId}/properties

# Health check
GET http://localhost:5267/api/templates/health
```

### **üìß Email Service APIs (Port 5030)**  
```http
# Send email with TMS-generated content
POST http://localhost:5030/api/email/send-generated-document
Content-Type: application/json

# Send email with CMS document attachments
POST http://localhost:5030/api/email/send-with-attachments
Content-Type: application/json

# Health check
GET http://localhost:5030/api/email/health
```

## üéØ Usage Examples

### **Example 1: Template Registration and Generation**
```http
# Step 1: Register a template (TMS calls CMS internally)
POST http://localhost:5267/api/templates/register
Content-Type: multipart/form-data

file: Email_Template.docx (contains {{CustomerName}}, {{PolicyNumber}})
name: Customer Email Template
description: Template for customer communications

# Response: { "templateId": "96cec0ae-a1f9-4e01-8e07-16ddd57b4b25" }

# Step 2: Generate document with data
POST http://localhost:5267/api/templates/generate
Content-Type: application/json

{
  "templateId": "96cec0ae-a1f9-4e01-8e07-16ddd57b4b25",
  "propertyValues": {
    "CustomerName": "John Smith",
    "PolicyNumber": "POL-2025-001234"
  },
  "exportFormat": "EmailHtml",
  "generatedBy": "API User"
}

# Response: { "generationId": "abc123...", "downloadUrl": "/api/templates/download/abc123..." }
```

### **Example 2: Email Automation**
```http
# Send email using TMS template (generates content on-the-fly)
POST http://localhost:5030/api/email/send-generated-document
Content-Type: application/json

{
  "to": ["john.smith@customer.com"],
  "subject": "Your Policy Documents",
  "templateId": "96cec0ae-a1f9-4e01-8e07-16ddd57b4b25",
  "propertyValues": {
    "CustomerName": "John Smith",
    "PolicyNumber": "POL-2025-001234",
    "SupportEmail": "support@manteq-me.com"
  },
  "exportFormat": "EmailHtml"
}

# The template content becomes the email body automatically!
```

### **Example 3: File Storage Verification**
```powershell
# Check where files are stored
Get-ChildItem "C:\ManteqStorage_Shared\CmsDocuments\"        # Original templates
Get-ChildItem "C:\ManteqStorage_Shared\TmsGenerated\"        # Generated documents (auto-cleanup)
Get-ChildItem "C:\ManteqStorage_Shared\TmsTemp\"             # Processing workspace
```

### **üé® Export Formats**
- üìÑ **Word** (.docx) - Preserve original formatting and layout
- üåê **HTML** - Web-compatible output with CSS styling  
- üìß **EmailHtml** - Email-optimized HTML with base64 embedded images
- üìã **PDF** - Professional document format (via LibreOffice)
- üìÇ **Original** - Keep source format unchanged

### **üìß EmailHtml Special Features**
- üñºÔ∏è **Base64 Images**: All images embedded directly (no external references)
- üé® **Email-Client Compatible**: Works with Outlook, Gmail, etc.
- üßπ **Clean HTML**: LibreOffice field codes removed automatically
- üì± **Responsive**: Mobile-friendly email layouts

## üîß Configuration

### **ÔøΩ Environment Variables (All Services)**
**Database connections are configured via `.env` files in each service directory - NO credentials in appsettings.json!**

**Required `.env` files:**
- `CMS.WebApi/.env`
- `TMS.WebApi/.env` 
- `EmailService.WebApi/.env`

**Template for each `.env` file:**
```env
DB_SERVER=YOUR_SERVER\\SQLEXPRESS
DB_DATABASE=CmsDatabase_Dev  
DB_INTEGRATED_SECURITY=true
DB_TRUST_SERVER_CERTIFICATE=true
```

### **üìÅ CMS Settings** (`CMS.WebApi/appsettings.json`)
```json
{
  "FileStorage": {
    "Path": "C:\\ManteqStorage_Shared\\CmsDocuments"  // Permanent document storage
  }
}
```

### **üéØ TMS Settings** (`TMS.WebApi/appsettings.json`)
```json
{
  "FileStorage": {
    "Path": "C:\\ManteqStorage_Shared\\CmsDocuments"  // For internal CMS services
  },
  "TMS": {
    "DocumentRetentionHours": 0.25,        // 15 minutes for generated files
    "CleanupIntervalMinutes": 5,           // Cleanup every 5 minutes
    "MaxFileSizeMB": 100,                  // 100MB file limit
    "AllowedFileTypes": [".docx", ".xlsx", ".pptx"],
    "LibreOfficeTimeout": 30000,           // 30 seconds
    "SharedStoragePath": "C:\\ManteqStorage_Shared\\TmsGenerated",  // Generated docs
    "TempUploadPath": "C:\\ManteqStorage_Shared\\TmsTemp"           // Working directory
  }
}
```

### **üìß Email Service Settings** (`EmailService.WebApi/appsettings.json`)
```json
{
  "EmailSettings": {
    "DefaultFromEmail": "noreply@manteq-me.com",
    "DefaultFromName": "Manteq System"
  }
}
```

### **üßπ Auto-Cleanup Behavior**
- **Templates**: ‚ùå **NEVER** cleaned up - stored permanently in CmsDocuments
- **Generated Documents**: ‚úÖ **Auto-cleanup** every 5 minutes - removed after 15 minutes
- **Temp Files**: ‚úÖ **Immediate cleanup** after processing

## üóÇÔ∏è Project Structure

```
Manteq-doc-system/
‚îú‚îÄ‚îÄ üìÑ ManteqDocumentSystem.sln    # Main solution (CMS + TMS + Email)
‚îú‚îÄ‚îÄ üìÑ README.md                   # This file (system overview)
‚îú‚îÄ‚îÄ üìÑ TEAM_GUIDE.md               # üÜï Comprehensive developer guide
‚îú‚îÄ‚îÄ üìÑ LICENSE.txt
‚îú‚îÄ‚îÄ 
‚îú‚îÄ‚îÄ üìÅ CMS.WebApi/                 # Content Management System (Port 5000)
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/               # REST API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ Data/                      # Entity Framework DbContext
‚îÇ   ‚îú‚îÄ‚îÄ Models/                    # Document models and DTOs
‚îÇ   ‚îú‚îÄ‚îÄ Services/                  # File storage and business logic
‚îÇ   ‚îú‚îÄ‚îÄ appsettings.json          # Database and storage configuration
‚îÇ   ‚îî‚îÄ‚îÄ README.md                  # CMS-specific documentation
‚îú‚îÄ‚îÄ 
‚îú‚îÄ‚îÄ üìÅ TMS.WebApi/                 # Template Management System (Port 5267)
‚îÇ   ‚îú‚îÄ‚îÄ TMS.WebApi.sln            # TMS solution with CMS dependency
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/               # Template processing endpoints
‚îÇ   ‚îú‚îÄ‚îÄ Services/                  # Document generation and embedding
‚îÇ   ‚îú‚îÄ‚îÄ Models/                    # Template models and requests
‚îÇ   ‚îú‚îÄ‚îÄ Infrastructure/            # Controller filtering for CMS
‚îÇ   ‚îú‚îÄ‚îÄ appsettings.json          # TMS and storage configuration  
‚îÇ   ‚îî‚îÄ‚îÄ README.md                  # TMS-specific documentation
‚îú‚îÄ‚îÄ 
‚îî‚îÄ‚îÄ üìÅ EmailService.WebApi/        # Email Service (Port 5030)
    ‚îú‚îÄ‚îÄ EmailService.WebApi.sln    # Email solution with TMS+CMS dependencies
    ‚îú‚îÄ‚îÄ Controllers/               # Email sending endpoints
    ‚îú‚îÄ‚îÄ Services/                  # TMS/CMS integration services
    ‚îú‚îÄ‚îÄ Models/                    # Email models and requests
    ‚îú‚îÄ‚îÄ appsettings.json          # Email configuration
    ‚îî‚îÄ‚îÄ README.md                  # Email service documentation
```

### **üóÑÔ∏è Database Schema**
```sql
CmsDatabase_Dev
‚îú‚îÄ‚îÄ Documents (CMS)               # All documents and templates
‚îÇ   ‚îú‚îÄ‚îÄ Id (PK)                   # Document identifier
‚îÇ   ‚îú‚îÄ‚îÄ FileName                  # Original file name
‚îÇ   ‚îú‚îÄ‚îÄ FilePath                  # Storage location
‚îÇ   ‚îú‚îÄ‚îÄ Description               # User description
‚îÇ   ‚îî‚îÄ‚îÄ CreatedAt                 # Upload timestamp
‚îî‚îÄ‚îÄ Templates (TMS)               # Template metadata
    ‚îú‚îÄ‚îÄ Id (PK)                   # Template identifier  
    ‚îú‚îÄ‚îÄ CmsDocumentId (FK)        # References Documents.Id
    ‚îú‚îÄ‚îÄ Name                      # Template name
    ‚îú‚îÄ‚îÄ Description               # Template description
    ‚îî‚îÄ‚îÄ CreatedAt                 # Registration timestamp
```

### **üìÅ File Storage Layout**
```
C:\ManteqStorage_Shared\
‚îú‚îÄ‚îÄ CmsDocuments\                 # üìÅ PERMANENT storage (CMS + TMS templates)
‚îÇ   ‚îú‚îÄ‚îÄ email-doc-test_xyz.docx   # Direct CMS uploads
‚îÇ   ‚îî‚îÄ‚îÄ Template_abc123.docx      # TMS registered templates
‚îú‚îÄ‚îÄ TmsGenerated\                 # üéØ TEMPORARY storage (15min retention)
‚îÇ   ‚îú‚îÄ‚îÄ generated_xyz.html        # EmailHtml output
‚îÇ   ‚îî‚îÄ‚îÄ generated_abc.pdf         # PDF conversions
‚îú‚îÄ‚îÄ TmsTemp\                      # üîÑ WORKING directory (immediate cleanup)
‚îÇ   ‚îî‚îÄ‚îÄ temp_processing_files     # During generation only
‚îî‚îÄ‚îÄ EmailAttachments\             # üìß EMAIL storage (future use)
    ‚îî‚îÄ‚îÄ attachment_files          # Email service files
```

## üß™ Testing the System

### **üîç Health Checks**
```powershell
# Verify all services are running
curl http://localhost:5000/api/documents/health   # CMS
curl http://localhost:5267/api/templates/health   # TMS  
curl http://localhost:5030/api/email/health       # Email Service

# All should return: {"status": "healthy", "service": "ServiceName"}
```

### **üìã Complete Workflow Test**
```powershell
# Step 1: Register a template (TMS ‚Üí CMS internally)
curl -X POST "http://localhost:5267/api/templates/register" `
     -F "file=@Email_Template.docx" `
     -F "name=Test Template" `
     -F "description=Test template for workflow"

# Step 2: Generate document
curl -X POST "http://localhost:5267/api/templates/generate" `
     -H "Content-Type: application/json" `
     -d '{"templateId":"your-template-id","propertyValues":{"CustomerName":"Test User"},"exportFormat":"EmailHtml"}'

# Step 3: Send email with generated content
curl -X POST "http://localhost:5030/api/email/send-generated-document" `
     -H "Content-Type: application/json" `
     -d '{"to":["test@example.com"],"subject":"Test Email","templateId":"your-template-id","propertyValues":{"CustomerName":"Test User"}}'
```

### **üåê Swagger UI Access**
- **CMS**: http://localhost:5000/swagger
- **TMS**: http://localhost:5267/swagger  
- **Email**: http://localhost:5030/swagger

## üöÄ Deployment and Scaling

### **Development Environment**
```powershell
# Run all services locally
dotnet run --project CMS.WebApi
dotnet run --project TMS.WebApi  
dotnet run --project EmailService.WebApi
```

### **Production Build**
```powershell
# Build optimized releases
dotnet publish CMS.WebApi -c Release -o ./publish/cms
dotnet publish TMS.WebApi -c Release -o ./publish/tms  
dotnet publish EmailService.WebApi -c Release -o ./publish/email
```

### **‚ö° Performance Features**
- üßπ **Auto-cleanup**: Generated files removed every 15 minutes
- üíæ **Memory efficient**: Shared storage with minimal memory footprint  
- üîÑ **Async processing**: Non-blocking document generation and email sending
- ‚öñÔ∏è **Load balancing ready**: Stateless services can scale horizontally
- üìä **Configurable timeouts**: LibreOffice process management and cleanup

### **üîß Production Considerations**
- **Database**: Upgrade to SQL Server Standard/Enterprise for production
- **Storage**: Consider Azure Blob Storage or NAS for shared file storage  
- **Monitoring**: Implement health checks and performance monitoring
- **Security**: Add authentication, authorization, and HTTPS certificates
- **Backup**: Regular database and file storage backups

## üìà Performance Features

- ‚ö° **Auto-cleanup**: Generated files removed every minute
- üíæ **Memory efficient**: Temporary file management
- üîÑ **Async processing**: Non-blocking operations
- üìä **Configurable timeouts**: LibreOffice process management

## üõ†Ô∏è Integration

### **Use TMS as Service**
```csharp
// In your project
services.AddScoped<IDocumentGenerationService, DocumentGenerationService>();
services.AddScoped<ITemplateService, TemplateService>();
```

### **CMS Integration**
TMS uses CMS services internally for document storage while exposing only TMS-specific endpoints.

## ‚ùå Troubleshooting

### **üîå Service Connection Issues**
```powershell
# Check if services are running
netstat -ano | findstr ":5000"    # CMS
netstat -ano | findstr ":5267"    # TMS
netstat -ano | findstr ":5030"    # Email Service

# Kill processes if needed
taskkill /PID <process-id> /F
```

### **üóÑÔ∏è Database Connection Problems**
```sql
-- Verify SQL Server is running
SELECT @@VERSION

-- Check database exists
USE master
SELECT name FROM sys.databases WHERE name = 'CmsDatabase_Dev'

-- If database is missing, it will be created automatically on first startup
```

### **üìÅ File Storage Issues**
```powershell
# Verify storage directories exist and have correct permissions
Test-Path "C:\ManteqStorage_Shared\CmsDocuments"
Test-Path "C:\ManteqStorage_Shared\TmsGenerated"
Get-Acl "C:\ManteqStorage_Shared"

# Recreate if missing
New-Item -ItemType Directory -Path "C:\ManteqStorage_Shared\CmsDocuments" -Force
```

### **‚öôÔ∏è LibreOffice Issues (TMS)**
```powershell
# Check LibreOffice installation
Test-Path "C:\Program Files\LibreOffice\program\soffice.exe"
Test-Path "C:\Program Files (x86)\LibreOffice\program\soffice.exe"

# Download from: https://www.libreoffice.org/download/download/
```

### **üîç Common Error Messages**
- **"Instance failure"** ‚Üí SQL Server not running or wrong connection string
- **"Directory not found"** ‚Üí Run storage setup commands above
- **"Template not found"** ‚Üí Template ID invalid or cleanup removed generated file
- **"LibreOffice timeout"** ‚Üí LibreOffice not installed or process hanging

## ÔøΩ Additional Resources

### **üìñ Documentation**
- üìÑ **[TEAM_GUIDE.md](TEAM_GUIDE.md)** - Comprehensive developer guide with workflows and examples
- üìÅ **[CMS README](CMS.WebApi/README.md)** - Content Management System documentation
- üéØ **[TMS README](TMS.WebApi/README.md)** - Template Management System documentation  
- üìß **[Email Service README](EmailService.WebApi/README.md)** - Email Service documentation

### **üåê API Documentation**
- **CMS Swagger**: http://localhost:5000/swagger
- **TMS Swagger**: http://localhost:5267/swagger
- **Email Swagger**: http://localhost:5030/swagger

### **üõ†Ô∏è Development Tools**
- **Visual Studio Code** with C# extension
- **Postman** or **curl** for API testing
- **SQL Server Management Studio** for database management
- **LibreOffice** for document conversion testing

---

## üìû Support

- **üë®‚Äçüíª Lead Developer**: Saleh Shalab
- **üìß Email**: salehshalab2@gmail.com  
- **üåê Repository**: https://github.com/SalehShalab87/Manteq-doc-system
- **üêõ Issues**: Use GitHub Issues for bug reports and feature requests

---

## üéâ Status: Production Ready

‚úÖ **All services fully tested and operational**  
‚úÖ **Shared storage architecture implemented**  
‚úÖ **Database schema stable and optimized**  
‚úÖ **Error handling and logging comprehensive**  
‚úÖ **API documentation complete**  
‚úÖ **Auto-cleanup and performance optimized**

**The Manteq Document System is ready for production deployment and provides a complete document automation solution with professional-grade template processing, multiple export formats, email automation, and seamless microservice integration.**

üöÄ **Happy document processing!**